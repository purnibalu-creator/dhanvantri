<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dhanvantari ‚Äî Ancient Healing Wisdom</title>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,300;1,400&family=Crimson+Pro:ital,wght@0,300;0,400;1,300&display=swap" rel="stylesheet">
<style>
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  :root {
    --bg: #0d0a06;
    --surface: #13100a;
    --surface2: #1c1610;
    --border: #2e2518;
    --gold: #c9975a;
    --gold-light: #e8c07a;
    --gold-dim: #7a5c33;
    --cream: #f0e6d0;
    --cream-dim: #a89070;
    --green: #5a8060;
    --green-light: #7ab585;
    --text: #e8dcc8;
    --text-dim: #8a7a65;
  }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'Crimson Pro', serif;
    font-size: 18px;
    line-height: 1.7;
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* Background texture */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background-image: 
      radial-gradient(ellipse 80% 50% at 20% 20%, rgba(201,151,90,0.06) 0%, transparent 60%),
      radial-gradient(ellipse 60% 80% at 80% 80%, rgba(90,128,96,0.05) 0%, transparent 60%);
    pointer-events: none;
    z-index: 0;
  }

  .mandala-bg {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 700px;
    height: 700px;
    opacity: 0.025;
    pointer-events: none;
    z-index: 0;
  }

  .container {
    position: relative;
    z-index: 1;
    max-width: 860px;
    margin: 0 auto;
    padding: 60px 24px 80px;
  }

  /* Header */
  header {
    text-align: center;
    margin-bottom: 64px;
    animation: fadeDown 1s ease both;
  }

  .om-symbol {
    font-size: 36px;
    color: var(--gold);
    opacity: 0.8;
    display: block;
    margin-bottom: 16px;
    animation: pulse 4s ease-in-out infinite;
  }

  @keyframes pulse {
    0%, 100% { opacity: 0.6; }
    50% { opacity: 1; }
  }

  h1 {
    font-family: 'Cormorant Garamond', serif;
    font-size: clamp(42px, 7vw, 72px);
    font-weight: 300;
    letter-spacing: 0.06em;
    color: var(--gold-light);
    line-height: 1;
    margin-bottom: 10px;
  }

  .subtitle {
    font-family: 'Cormorant Garamond', serif;
    font-style: italic;
    font-size: 16px;
    color: var(--cream-dim);
    letter-spacing: 0.15em;
    text-transform: uppercase;
    margin-bottom: 20px;
  }

  .divider {
    display: flex;
    align-items: center;
    gap: 16px;
    justify-content: center;
    color: var(--gold-dim);
    font-size: 12px;
    letter-spacing: 0.3em;
    margin: 20px 0;
  }
  .divider::before, .divider::after {
    content: '';
    width: 80px;
    height: 1px;
    background: linear-gradient(90deg, transparent, var(--gold-dim));
  }
  .divider::after { background: linear-gradient(270deg, transparent, var(--gold-dim)); }

  .disclaimer {
    font-size: 13px;
    color: var(--text-dim);
    font-style: italic;
    max-width: 520px;
    margin: 0 auto;
    padding: 12px 20px;
    border: 1px solid var(--border);
    border-radius: 2px;
    background: rgba(201,151,90,0.03);
  }

  /* Doshas */
  .dosha-selector {
    display: flex;
    gap: 12px;
    justify-content: center;
    margin-bottom: 40px;
    flex-wrap: wrap;
    animation: fadeUp 0.8s 0.3s ease both;
  }

  .dosha-btn {
    padding: 8px 22px;
    border: 1px solid var(--border);
    background: transparent;
    color: var(--cream-dim);
    font-family: 'Cormorant Garamond', serif;
    font-size: 15px;
    letter-spacing: 0.1em;
    cursor: pointer;
    transition: all 0.3s;
    border-radius: 1px;
  }
  .dosha-btn:hover, .dosha-btn.active {
    background: rgba(201,151,90,0.1);
    border-color: var(--gold-dim);
    color: var(--gold-light);
  }
  .dosha-btn.active {
    background: rgba(201,151,90,0.15);
    border-color: var(--gold);
  }

  /* Input area */
  .input-section {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 4px;
    padding: 32px;
    margin-bottom: 32px;
    animation: fadeUp 0.8s 0.4s ease both;
    position: relative;
    overflow: hidden;
  }

  .input-section::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0;
    height: 2px;
    background: linear-gradient(90deg, transparent, var(--gold-dim), transparent);
  }

  label {
    display: block;
    font-family: 'Cormorant Garamond', serif;
    font-size: 13px;
    letter-spacing: 0.2em;
    text-transform: uppercase;
    color: var(--gold);
    margin-bottom: 14px;
  }

  textarea {
    width: 100%;
    background: var(--bg);
    border: 1px solid var(--border);
    color: var(--text);
    font-family: 'Crimson Pro', serif;
    font-size: 17px;
    line-height: 1.7;
    padding: 16px 20px;
    resize: vertical;
    min-height: 130px;
    outline: none;
    transition: border-color 0.3s;
    border-radius: 2px;
  }

  textarea:focus { border-color: var(--gold-dim); }
  textarea::placeholder { color: var(--text-dim); font-style: italic; }

  .btn-row {
    display: flex;
    align-items: center;
    gap: 16px;
    margin-top: 20px;
    flex-wrap: wrap;
  }

  .btn-primary {
    padding: 13px 40px;
    background: linear-gradient(135deg, var(--gold-dim), var(--gold));
    border: none;
    color: var(--bg);
    font-family: 'Cormorant Garamond', serif;
    font-size: 16px;
    font-weight: 600;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    cursor: pointer;
    transition: all 0.3s;
    border-radius: 2px;
  }

  .btn-primary:hover:not(:disabled) {
    transform: translateY(-2px);
    box-shadow: 0 8px 24px rgba(201,151,90,0.25);
    background: linear-gradient(135deg, var(--gold), var(--gold-light));
  }

  .btn-primary:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  .btn-clear {
    padding: 13px 24px;
    background: transparent;
    border: 1px solid var(--border);
    color: var(--text-dim);
    font-family: 'Crimson Pro', serif;
    font-size: 15px;
    cursor: pointer;
    transition: all 0.3s;
    border-radius: 2px;
  }
  .btn-clear:hover { border-color: var(--text-dim); color: var(--text); }

  /* Loading */
  .loading {
    display: none;
    text-align: center;
    padding: 48px;
    animation: fadeIn 0.4s ease;
  }

  .loading.visible { display: block; }

  .lotus-loader {
    width: 60px;
    height: 60px;
    margin: 0 auto 20px;
    animation: rotateLotus 3s linear infinite;
  }

  @keyframes rotateLotus {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
  }

  .loading-text {
    font-family: 'Cormorant Garamond', serif;
    font-style: italic;
    color: var(--gold-dim);
    font-size: 16px;
    letter-spacing: 0.1em;
    animation: fadeInOut 2s ease-in-out infinite;
  }

  @keyframes fadeInOut {
    0%, 100% { opacity: 0.5; }
    50% { opacity: 1; }
  }

  /* Response */
  .response-section {
    display: none;
    animation: fadeUp 0.6s ease both;
  }

  .response-section.visible { display: block; }

  .response-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 4px;
    overflow: hidden;
    margin-bottom: 20px;
  }

  .response-card-header {
    background: linear-gradient(90deg, rgba(201,151,90,0.12), rgba(201,151,90,0.04));
    border-bottom: 1px solid var(--border);
    padding: 18px 28px;
    display: flex;
    align-items: center;
    gap: 12px;
  }

  .response-card-header .icon { font-size: 20px; }

  .response-card-header h2 {
    font-family: 'Cormorant Garamond', serif;
    font-size: 20px;
    font-weight: 400;
    letter-spacing: 0.08em;
    color: var(--gold-light);
  }

  .response-body {
    padding: 28px;
    color: var(--text);
    line-height: 1.85;
  }

  .response-body h3 {
    font-family: 'Cormorant Garamond', serif;
    font-size: 22px;
    font-weight: 400;
    color: var(--gold);
    margin: 24px 0 10px;
    padding-bottom: 6px;
    border-bottom: 1px solid var(--border);
    letter-spacing: 0.05em;
  }

  .response-body h3:first-child { margin-top: 0; }

  .response-body p {
    margin-bottom: 12px;
    font-size: 17px;
  }

  .response-body ul, .response-body ol {
    margin: 8px 0 16px 24px;
  }

  .response-body li {
    margin-bottom: 6px;
    font-size: 17px;
  }

  .response-body strong {
    color: var(--cream);
    font-weight: 600;
  }

  .response-body em {
    color: var(--gold-dim);
    font-style: italic;
  }

  .herb-tag {
    display: inline-block;
    background: rgba(90,128,96,0.15);
    border: 1px solid rgba(90,128,96,0.3);
    color: var(--green-light);
    padding: 2px 10px;
    border-radius: 2px;
    font-size: 14px;
    margin: 2px 4px;
    font-style: italic;
  }

  .warning-box {
    background: rgba(201,151,90,0.06);
    border-left: 3px solid var(--gold-dim);
    padding: 14px 20px;
    margin: 20px 0 0;
    border-radius: 0 2px 2px 0;
    font-size: 14px;
    color: var(--cream-dim);
    font-style: italic;
  }

  /* Error */
  .error-msg {
    background: rgba(180,60,60,0.1);
    border: 1px solid rgba(180,60,60,0.3);
    border-radius: 4px;
    padding: 16px 24px;
    color: #e08080;
    font-style: italic;
    display: none;
  }
  .error-msg.visible { display: block; }

  /* Animations */
  @keyframes fadeDown {
    from { opacity: 0; transform: translateY(-20px); }
    to { opacity: 1; transform: translateY(0); }
  }

  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
  }

  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  /* Footer */
  footer {
    text-align: center;
    margin-top: 64px;
    font-size: 13px;
    color: var(--text-dim);
    letter-spacing: 0.08em;
  }

  @media (max-width: 600px) {
    .container { padding: 40px 16px 60px; }
    .input-section { padding: 24px 20px; }
    .response-body { padding: 20px; }
  }
</style>
</head>
<body>

<!-- Background Mandala SVG -->
<svg class="mandala-bg" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
  <g fill="none" stroke="#c9975a" stroke-width="0.3">
    <circle cx="100" cy="100" r="90"/><circle cx="100" cy="100" r="75"/><circle cx="100" cy="100" r="60"/>
    <circle cx="100" cy="100" r="45"/><circle cx="100" cy="100" r="30"/><circle cx="100" cy="100" r="15"/>
    <line x1="100" y1="10" x2="100" y2="190"/><line x1="10" y1="100" x2="190" y2="100"/>
    <line x1="27" y1="27" x2="173" y2="173"/><line x1="173" y1="27" x2="27" y2="173"/>
    <line x1="15" y1="63" x2="185" y2="137"/><line x1="63" y1="15" x2="137" y2="185"/>
    <line x1="185" y1="63" x2="15" y2="137"/><line x1="137" y1="15" x2="63" y2="185"/>
    <polygon points="100,20 180,160 20,160"/>
    <polygon points="100,180 20,40 180,40"/>
  </g>
</svg>

<div class="container">

  <header>
    <span class="om-symbol">‡•ê</span>
    <h1>Dhanvantari</h1>
    <p class="subtitle">Ancient Healing Wisdom ¬∑ Ayurveda & Homeopathy</p>
    <div class="divider">‚ú¶</div>
    <p class="disclaimer">
      This application offers traditional wellness guidance rooted in Ayurvedic and homeopathic traditions. 
      It is not a substitute for professional medical advice. Always consult a qualified physician for serious conditions.
    </p>
  </header>

  <!-- Dosha selector -->
  <div class="dosha-selector">
    <span style="font-family:'Cormorant Garamond',serif; font-style:italic; color:var(--text-dim); align-self:center; font-size:15px;">Your constitution (optional):</span>
    <button class="dosha-btn" onclick="toggleDosha(this,'Vata')">VƒÅta</button>
    <button class="dosha-btn" onclick="toggleDosha(this,'Pitta')">Pitta</button>
    <button class="dosha-btn" onclick="toggleDosha(this,'Kapha')">Kapha</button>
    <button class="dosha-btn" onclick="toggleDosha(this,'Unknown')">Unsure</button>
  </div>

  <!-- Input -->
  <div class="input-section">
    <label>Describe Your Ailments &amp; Symptoms</label>
    <textarea id="symptomsInput" placeholder="e.g. I have had a persistent dry cough for three days, along with a mild sore throat and fatigue. I also notice my digestion has been sluggish lately..."></textarea>
    <div class="btn-row">
      <button class="btn-primary" id="submitBtn" onclick="getRecommendations()">Seek Guidance ‚ú¶</button>
      <button class="btn-clear" onclick="clearAll()">Clear</button>
    </div>
  </div>

  <!-- Loading -->
  <div class="loading" id="loadingSection">
    <svg class="lotus-loader" viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg">
      <g fill="none" stroke="#c9975a" stroke-width="1.2">
        <ellipse cx="30" cy="30" rx="8" ry="16" transform="rotate(0 30 30)"/>
        <ellipse cx="30" cy="30" rx="8" ry="16" transform="rotate(45 30 30)"/>
        <ellipse cx="30" cy="30" rx="8" ry="16" transform="rotate(90 30 30)"/>
        <ellipse cx="30" cy="30" rx="8" ry="16" transform="rotate(135 30 30)"/>
        <circle cx="30" cy="30" r="5" fill="rgba(201,151,90,0.3)"/>
      </g>
    </svg>
    <div class="loading-text">Consulting ancient texts...</div>
  </div>

  <!-- Error -->
  <div class="error-msg" id="errorMsg"></div>

  <!-- Response -->
  <div class="response-section" id="responseSection">
    <div class="response-card">
      <div class="response-card-header">
        <span class="icon">üåø</span>
        <h2>Ancient Healing Recommendations</h2>
      </div>
      <div class="response-body" id="responseBody"></div>
    </div>
    <div class="warning-box">
      ‚ö† The remedies above are drawn from traditional Ayurvedic and homeopathic knowledge systems. Individual responses to herbal and homeopathic treatments vary. Consult an Ayurvedic practitioner or licensed homeopath for personalised guidance, and seek immediate medical attention for severe or worsening conditions.
    </div>
  </div>

  <footer>
    <p>Dhanvantari ‚Äî God of Ayurveda &amp; Divine Healer ¬∑ Ancient Wisdom for Modern Wellness</p>
  </footer>

</div>

<script>
let selectedDosha = null;

function toggleDosha(btn, dosha) {
  document.querySelectorAll('.dosha-btn').forEach(b => b.classList.remove('active'));
  if (selectedDosha === dosha) {
    selectedDosha = null;
  } else {
    selectedDosha = dosha;
    btn.classList.add('active');
  }
}

function clearAll() {
  document.getElementById('symptomsInput').value = '';
  document.getElementById('responseSection').classList.remove('visible');
  document.getElementById('errorMsg').classList.remove('visible');
  document.getElementById('responseBody').innerHTML = '';
  document.querySelectorAll('.dosha-btn').forEach(b => b.classList.remove('active'));
  selectedDosha = null;
}

function setLoading(v) {
  document.getElementById('loadingSection').classList.toggle('visible', v);
  document.getElementById('submitBtn').disabled = v;
}

function renderMarkdown(text) {
  // Simple markdown-to-HTML renderer
  return text
    .replace(/^### (.+)$/gm, '<h3>$1</h3>')
    .replace(/^## (.+)$/gm, '<h3>$1</h3>')
    .replace(/^# (.+)$/gm, '<h3>$1</h3>')
    .replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>')
    .replace(/\*(.+?)\*/g, '<em>$1</em>')
    .replace(/^- (.+)$/gm, '<li>$1</li>')
    .replace(/(<li>.*<\/li>\n?)+/g, '<ul>$&</ul>')
    .replace(/\n\n/g, '</p><p>')
    .replace(/^(?!<[h|u|o|l])/gm, '')
    .replace(/^(.+)$/gm, m => m.startsWith('<') ? m : `<p>${m}</p>`)
    .replace(/<p><\/p>/g, '');
}

async function getRecommendations() {
  const symptoms = document.getElementById('symptomsInput').value.trim();
  if (!symptoms) {
    alert('Please describe your symptoms first.');
    return;
  }

  document.getElementById('responseSection').classList.remove('visible');
  document.getElementById('errorMsg').classList.remove('visible');
  setLoading(true);

  const doshaContext = selectedDosha && selectedDosha !== 'Unknown'
    ? `The patient identifies as predominantly ${selectedDosha} constitution.`
    : '';

  const systemPrompt = `You are Dhanvantari, an expert in traditional Ayurvedic medicine and classical homeopathy with deep knowledge of ancient healing texts including the Charaka Samhita, Sushruta Samhita, Ashtanga Hridayam, and classical homeopathic Materia Medica.

Your role is to provide traditional, holistic wellness guidance using ONLY:
- Ayurvedic herbs, formulations (churnas, kwathas, rasayanas), dietary advice, and lifestyle practices (dinacharya, ritucharya, yoga, pranayama)
- Classical homeopathic remedies with their potencies and indications
- Traditional home remedies rooted in ancient healing traditions

Format your response clearly with sections:

### Ayurvedic Understanding
Brief dosha analysis and root imbalance.

### Recommended Herbs & Formulations
Key herbs with preparation method and dosage.

### Classical Homeopathic Remedies
2-3 homeopathic remedies with potencies and indications.

### Dietary & Lifestyle Guidance
Specific foods, spices, practices to follow and avoid.

### Healing Practices
Yoga postures, pranayama, oil application, or other traditional practices.

Use Sanskrit names alongside common names. Be specific about preparations, potencies, and timing. Speak with the wisdom of ancient tradition.`;

  const userMessage = `${doshaContext ? doshaContext + '\n\n' : ''}Patient symptoms: ${symptoms}`;

  try {
    const response = await fetch('https://api.anthropic.com/v1/messages', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        model: 'claude-sonnet-4-20250514',
        max_tokens: 1000,
        system: systemPrompt,
        messages: [{ role: 'user', content: userMessage }]
      })
    });

    const data = await response.json();
    
    if (!response.ok) {
      throw new Error(data.error?.message || 'API error');
    }

    const text = data.content.map(c => c.text || '').join('\n');
    document.getElementById('responseBody').innerHTML = renderMarkdown(text);
    document.getElementById('responseSection').classList.add('visible');

    document.getElementById('responseSection').scrollIntoView({ behavior: 'smooth', block: 'start' });

  } catch (err) {
    const errorEl = document.getElementById('errorMsg');
    errorEl.textContent = 'Unable to retrieve guidance: ' + err.message;
    errorEl.classList.add('visible');
  } finally {
    setLoading(false);
  }
}

// Allow Enter+Ctrl to submit
document.getElementById('symptomsInput').addEventListener('keydown', e => {
  if (e.key === 'Enter' && (e.ctrlKey || e.metaKey)) getRecommendations();
});
</script>
</body>
</html>
